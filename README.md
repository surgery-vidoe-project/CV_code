this is image preprocessing code.
